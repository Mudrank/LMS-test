{"ast":null,"code":"import _extends from\"@babel/runtime/helpers/extends\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createForOfIteratorHelperLoose(o,allowArrayLike){var it=typeof Symbol!==\"undefined\"&&o[Symbol.iterator]||o[\"@@iterator\"];if(it)return(it=it.call(o)).next.bind(it);if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length===\"number\"){if(it)o=it;var i=0;return function(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};};}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import React from'react';import findNodeHandle from\"react-native-web/dist/exports/findNodeHandle\";import Platform from\"react-native-web/dist/exports/Platform\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import ReanimatedEventEmitter from\"./ReanimatedEventEmitter\";import AnimatedEvent from\"./reanimated1/core/AnimatedEvent\";import AnimatedNode from\"./reanimated1/core/AnimatedNode\";import AnimatedValue from\"./reanimated1/core/AnimatedValue\";import{createOrReusePropsNode}from\"./reanimated1/core/AnimatedProps\";import WorkletEventHandler from\"./reanimated2/WorkletEventHandler\";import setAndForwardRef from\"./setAndForwardRef\";import invariant from'fbjs/lib/invariant';import{adaptViewConfig}from\"./ConfigHelper\";import{RNRenderer}from\"./reanimated2/platform-specific/RNRenderer\";var NODE_MAPPING=new Map();function listener(data){var component=NODE_MAPPING.get(data.viewTag);component&&component._updateFromNative(data.props);}function dummyListener(){}function hasAnimatedNodes(value){if(value instanceof AnimatedNode){return true;}if(Array.isArray(value)){return value.some(function(item){return hasAnimatedNodes(item);});}if(value&&typeof value==='object'){return Object.keys(value).some(function(key){return hasAnimatedNodes(value[key]);});}return false;}function flattenArray(array){if(!Array.isArray(array)){return array;}var resultArr=[];var _flattenArray=function _flattenArray(arr){arr.forEach(function(item){if(Array.isArray(item)){_flattenArray(item);}else{resultArr.push(item);}});};_flattenArray(array);return resultArr;}export default function createAnimatedComponent(Component){invariant(typeof Component!=='function'||Component.prototype&&Component.prototype.isReactComponent,'`createAnimatedComponent` does not support stateless functional components; '+'use a class component instead.');var AnimatedComponent=function(_React$Component){_inherits(AnimatedComponent,_React$Component);var _super=_createSuper(AnimatedComponent);function AnimatedComponent(props){var _this;_classCallCheck(this,AnimatedComponent);_this=_super.call(this,props);_this._invokeAnimatedPropsCallbackOnMount=false;_this._animatedPropsCallback=function(){if(_this._component==null){_this._invokeAnimatedPropsCallbackOnMount=true;}else if(typeof _this._component.setNativeProps!=='function'){_this.forceUpdate();}else{_this._component.setNativeProps(_this._propsAnimated.__getValue());}};_this._setComponentRef=setAndForwardRef({getForwardedRef:function getForwardedRef(){return _this.props.forwardedRef;},setLocalRef:function setLocalRef(ref){if(ref!==_this._component){_this._component=ref;}if(ref!=null&&ref.getNode==null){ref.getNode=function(){var _ref$constructor$name;console.warn('%s: Calling %s on the ref of an Animated component '+'is no longer necessary. You can now directly use the ref '+'instead. This method will be removed in a future release.',(_ref$constructor$name=ref.constructor.name)!=null?_ref$constructor$name:'<<anonymous>>','getNode()');return ref;};}}});_this._attachProps(_this.props);if(process.env.JEST_WORKER_ID){_this.animatedStyle={value:{}};}return _this;}_createClass(AnimatedComponent,[{key:\"componentWillUnmount\",value:function componentWillUnmount(){this._detachPropUpdater();this._propsAnimated&&this._propsAnimated.__detach();this._detachNativeEvents();}},{key:\"componentDidMount\",value:function componentDidMount(){if(this._invokeAnimatedPropsCallbackOnMount){this._invokeAnimatedPropsCallbackOnMount=false;this._animatedPropsCallback();}this._propsAnimated&&this._propsAnimated.setNativeView(this._component);this._attachNativeEvents();this._attachPropUpdater();this._attachAnimatedStyles();}},{key:\"_getEventViewRef\",value:function _getEventViewRef(){return this._component.getScrollableNode?this._component.getScrollableNode():this._component;}},{key:\"_attachNativeEvents\",value:function _attachNativeEvents(){var node=this._getEventViewRef();var viewTag=findNodeHandle(node);for(var key in this.props){var prop=this.props[key];if(prop instanceof AnimatedEvent){prop.attachEvent(node,key);}else if(prop!=null&&prop.current&&prop.current instanceof WorkletEventHandler){prop.current.registerForEvents(viewTag,key);}}}},{key:\"_detachNativeEvents\",value:function _detachNativeEvents(){var node=this._getEventViewRef();for(var key in this.props){var prop=this.props[key];if(prop instanceof AnimatedEvent){prop.detachEvent(node,key);}else if(prop!=null&&prop.current&&prop.current instanceof WorkletEventHandler){prop.current.unregisterFromEvents();}}}},{key:\"_reattachNativeEvents\",value:function _reattachNativeEvents(prevProps){var node=this._getEventViewRef();var attached=new Set();var nextEvts=new Set();var viewTag;for(var key in this.props){var prop=this.props[key];if(prop instanceof AnimatedEvent){nextEvts.add(prop.__nodeID);}else if(prop!=null&&prop.current&&prop.current instanceof WorkletEventHandler){if(viewTag===undefined){viewTag=prop.current.viewTag;}}}for(var _key in prevProps){var _prop=this.props[_key];if(_prop instanceof AnimatedEvent){if(!nextEvts.has(_prop.__nodeID)){_prop.detachEvent(node,_key);}else{attached.add(_prop.__nodeID);}}else if(_prop!=null&&_prop.current&&_prop.current instanceof WorkletEventHandler&&_prop.current.reattachNeeded){_prop.current.unregisterFromEvents();}}for(var _key2 in this.props){var _prop2=this.props[_key2];if(_prop2 instanceof AnimatedEvent&&!attached.has(_prop2.__nodeID)){_prop2.attachEvent(node,_key2);}else if(_prop2!=null&&_prop2.current&&_prop2.current instanceof WorkletEventHandler&&_prop2.current.reattachNeeded){_prop2.current.registerForEvents(viewTag,_key2);_prop2.current.reattachNeeded=false;}}}},{key:\"_attachProps\",value:function _attachProps(nextProps){var oldPropsAnimated=this._propsAnimated;this._propsAnimated=createOrReusePropsNode(nextProps,this._animatedPropsCallback,oldPropsAnimated);if(oldPropsAnimated!==this._propsAnimated){oldPropsAnimated&&oldPropsAnimated.__detach();}}},{key:\"_updateFromNative\",value:function _updateFromNative(props){var _this$_component$setN,_this$_component;(_this$_component$setN=(_this$_component=this._component).setNativeProps)==null?void 0:_this$_component$setN.call(_this$_component,props);}},{key:\"_attachPropUpdater\",value:function _attachPropUpdater(){var viewTag=findNodeHandle(this);NODE_MAPPING.set(viewTag,this);if(NODE_MAPPING.size===1){ReanimatedEventEmitter.addListener('onReanimatedPropsChange',listener);}}},{key:\"_attachAnimatedStyles\",value:function _attachAnimatedStyles(){var _this2=this,_this$props$animatedP;var styles=Array.isArray(this.props.style)?this.props.style:[this.props.style];styles=flattenArray(styles);var viewTag,viewName;if(Platform.OS==='web'){viewTag=findNodeHandle(this);viewName=null;}else{var _hostInstance$viewCon;var hostInstance=RNRenderer.findHostInstance_DEPRECATED(this);if(!hostInstance){throw new Error('Cannot find host instance for this component. Maybe it renders nothing?');}viewTag=hostInstance==null?void 0:hostInstance._nativeTag;viewName=hostInstance==null?void 0:(_hostInstance$viewCon=hostInstance.viewConfig)==null?void 0:_hostInstance$viewCon.uiViewClassName;if(hostInstance&&this._hasReanimated2Props(styles)&&hostInstance.viewConfig){adaptViewConfig(hostInstance.viewConfig);}}styles.forEach(function(style){if(style!=null&&style.viewDescriptor){style.viewDescriptor.value={tag:viewTag,name:viewName};if(process.env.JEST_WORKER_ID){_this2.animatedStyle.value=_objectSpread(_objectSpread({},_this2.animatedStyle.value),style.initial);style.animatedStyle.current=_this2.animatedStyle;}}});if((_this$props$animatedP=this.props.animatedProps)!=null&&_this$props$animatedP.viewDescriptor){this.props.animatedProps.viewDescriptor.value={tag:viewTag,name:viewName};}}},{key:\"_hasReanimated2Props\",value:function _hasReanimated2Props(flattenStyles){var _this$props$animatedP2;if((_this$props$animatedP2=this.props.animatedProps)!=null&&_this$props$animatedP2.viewDescriptor){return true;}if(this.props.style){for(var _iterator=_createForOfIteratorHelperLoose(flattenStyles),_step;!(_step=_iterator()).done;){var style=_step.value;if(style!=null&&style.hasOwnProperty('viewDescriptor')){return true;}}}return false;}},{key:\"_detachPropUpdater\",value:function _detachPropUpdater(){var viewTag=findNodeHandle(this);NODE_MAPPING.delete(viewTag);if(NODE_MAPPING.size===0){ReanimatedEventEmitter.removeAllListeners('onReanimatedPropsChange');}}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){this._attachProps(this.props);this._reattachNativeEvents(prevProps);this._propsAnimated&&this._propsAnimated.setNativeView(this._component);}},{key:\"_filterNonAnimatedStyle\",value:function _filterNonAnimatedStyle(inputStyle){var style={};for(var key in inputStyle){var value=inputStyle[key];if(!hasAnimatedNodes(value)){style[key]=value;}else if(value instanceof AnimatedValue){style[key]=value._startingValue;}}return style;}},{key:\"_filterNonAnimatedProps\",value:function _filterNonAnimatedProps(inputProps){var _this3=this;var props={};var _loop=function _loop(key){var value=inputProps[key];if(key==='style'){var styles=Array.isArray(value)?value:[value];var processedStyle=styles.map(function(style){if(style&&style.viewDescriptor){if(style.viewRef.current===null){style.viewRef.current=_this3;}return style.initial;}else{return style;}});props[key]=_this3._filterNonAnimatedStyle(StyleSheet.flatten(processedStyle));}else if(key==='animatedProps'){Object.keys(value.initial).forEach(function(key){props[key]=value.initial[key];if(value.viewRef.current===null){value.viewRef.current=_this3;}});}else if(value instanceof AnimatedEvent){props[key]=dummyListener;}else if(value!=null&&value.current&&value.current instanceof WorkletEventHandler){if(value.current.eventNames.length>0){value.current.eventNames.forEach(function(eventName){props[eventName]=value.current.listeners?value.current.listeners[eventName]:dummyListener;});}else{props[key]=dummyListener;}}else if(!(value instanceof AnimatedNode)){props[key]=value;}else if(value instanceof AnimatedValue){props[key]=value._startingValue;}};for(var key in inputProps){_loop(key);}return props;}},{key:\"render\",value:function render(){var props=this._filterNonAnimatedProps(this.props);if(process.env.JEST_WORKER_ID){props.animatedStyle=this.animatedStyle;}var platformProps=Platform.select({web:{},default:{collapsable:false}});return React.createElement(Component,_extends({},props,{ref:this._setComponentRef},platformProps));}}]);return AnimatedComponent;}(React.Component);AnimatedComponent.displayName=\"AnimatedComponent(\"+(Component.displayName||Component.name||'Component')+\")\";return React.forwardRef(function AnimatedComponentWrapper(props,ref){return React.createElement(AnimatedComponent,_extends({},props,ref==null?null:{forwardedRef:ref}));});}","map":{"version":3,"sources":["C:/Users/Mudrank Gupta/OneDrive/WHJR/Pro/Wireless-Library-management/node_modules/react-native-reanimated/lib/createAnimatedComponent.js"],"names":["React","ReanimatedEventEmitter","AnimatedEvent","AnimatedNode","AnimatedValue","createOrReusePropsNode","WorkletEventHandler","setAndForwardRef","invariant","adaptViewConfig","RNRenderer","NODE_MAPPING","Map","listener","data","component","get","viewTag","_updateFromNative","props","dummyListener","hasAnimatedNodes","value","Array","isArray","some","item","Object","keys","key","flattenArray","array","resultArr","_flattenArray","arr","forEach","push","createAnimatedComponent","Component","prototype","isReactComponent","AnimatedComponent","_invokeAnimatedPropsCallbackOnMount","_animatedPropsCallback","_component","setNativeProps","forceUpdate","_propsAnimated","__getValue","_setComponentRef","getForwardedRef","forwardedRef","setLocalRef","ref","getNode","console","warn","constructor","name","_attachProps","process","env","JEST_WORKER_ID","animatedStyle","_detachPropUpdater","__detach","_detachNativeEvents","setNativeView","_attachNativeEvents","_attachPropUpdater","_attachAnimatedStyles","getScrollableNode","node","_getEventViewRef","findNodeHandle","prop","attachEvent","current","registerForEvents","detachEvent","unregisterFromEvents","prevProps","attached","Set","nextEvts","add","__nodeID","undefined","has","reattachNeeded","nextProps","oldPropsAnimated","set","size","addListener","styles","style","viewName","Platform","OS","hostInstance","findHostInstance_DEPRECATED","Error","_nativeTag","viewConfig","uiViewClassName","_hasReanimated2Props","viewDescriptor","tag","initial","animatedProps","flattenStyles","hasOwnProperty","delete","removeAllListeners","_reattachNativeEvents","inputStyle","_startingValue","inputProps","processedStyle","map","viewRef","_filterNonAnimatedStyle","StyleSheet","flatten","eventNames","length","eventName","listeners","_filterNonAnimatedProps","platformProps","select","web","default","collapsable","displayName","forwardRef","AnimatedComponentWrapper"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { findNodeHandle, Platform, StyleSheet } from 'react-native';\nimport ReanimatedEventEmitter from './ReanimatedEventEmitter';\n\nimport AnimatedEvent from './reanimated1/core/AnimatedEvent';\nimport AnimatedNode from './reanimated1/core/AnimatedNode';\nimport AnimatedValue from './reanimated1/core/AnimatedValue';\nimport { createOrReusePropsNode } from './reanimated1/core/AnimatedProps';\nimport WorkletEventHandler from './reanimated2/WorkletEventHandler';\nimport setAndForwardRef from './setAndForwardRef';\n\nimport invariant from 'fbjs/lib/invariant';\nimport { adaptViewConfig } from './ConfigHelper';\nimport { RNRenderer } from './reanimated2/platform-specific/RNRenderer';\n\nconst NODE_MAPPING = new Map();\n\nfunction listener(data) {\n  const component = NODE_MAPPING.get(data.viewTag);\n  component && component._updateFromNative(data.props);\n}\n\nfunction dummyListener() {\n  // empty listener we use to assign to listener properties for which animated\n  // event is used.\n}\n\nfunction hasAnimatedNodes(value) {\n  if (value instanceof AnimatedNode) {\n    return true;\n  }\n  if (Array.isArray(value)) {\n    return value.some((item) => hasAnimatedNodes(item));\n  }\n  if (value && typeof value === 'object') {\n    return Object.keys(value).some((key) => hasAnimatedNodes(value[key]));\n  }\n  return false;\n}\n\nfunction flattenArray(array) {\n  if (!Array.isArray(array)) {\n    return array;\n  }\n  const resultArr = [];\n\n  const _flattenArray = (arr) => {\n    arr.forEach((item) => {\n      if (Array.isArray(item)) {\n        _flattenArray(item);\n      } else {\n        resultArr.push(item);\n      }\n    });\n  };\n  _flattenArray(array);\n  return resultArr;\n}\n\nexport default function createAnimatedComponent(Component) {\n  invariant(\n    typeof Component !== 'function' ||\n      (Component.prototype && Component.prototype.isReactComponent),\n    '`createAnimatedComponent` does not support stateless functional components; ' +\n      'use a class component instead.'\n  );\n\n  class AnimatedComponent extends React.Component {\n    _invokeAnimatedPropsCallbackOnMount = false;\n\n    constructor(props) {\n      super(props);\n      this._attachProps(this.props);\n      if (process.env.JEST_WORKER_ID) {\n        this.animatedStyle = { value: {} };\n      }\n    }\n\n    componentWillUnmount() {\n      this._detachPropUpdater();\n      this._propsAnimated && this._propsAnimated.__detach();\n      this._detachNativeEvents();\n    }\n\n    componentDidMount() {\n      if (this._invokeAnimatedPropsCallbackOnMount) {\n        this._invokeAnimatedPropsCallbackOnMount = false;\n        this._animatedPropsCallback();\n      }\n\n      this._propsAnimated && this._propsAnimated.setNativeView(this._component);\n      this._attachNativeEvents();\n      this._attachPropUpdater();\n      this._attachAnimatedStyles();\n    }\n\n    _getEventViewRef() {\n      // Make sure to get the scrollable node for components that implement\n      // `ScrollResponder.Mixin`.\n      return this._component.getScrollableNode\n        ? this._component.getScrollableNode()\n        : this._component;\n    }\n\n    _attachNativeEvents() {\n      const node = this._getEventViewRef();\n      const viewTag = findNodeHandle(node);\n\n      for (const key in this.props) {\n        const prop = this.props[key];\n        if (prop instanceof AnimatedEvent) {\n          prop.attachEvent(node, key);\n        } else if (\n          prop?.current &&\n          prop.current instanceof WorkletEventHandler\n        ) {\n          prop.current.registerForEvents(viewTag, key);\n        }\n      }\n    }\n\n    _detachNativeEvents() {\n      const node = this._getEventViewRef();\n\n      for (const key in this.props) {\n        const prop = this.props[key];\n        if (prop instanceof AnimatedEvent) {\n          prop.detachEvent(node, key);\n        } else if (\n          prop?.current &&\n          prop.current instanceof WorkletEventHandler\n        ) {\n          prop.current.unregisterFromEvents();\n        }\n      }\n    }\n\n    _reattachNativeEvents(prevProps) {\n      const node = this._getEventViewRef();\n      const attached = new Set();\n      const nextEvts = new Set();\n      let viewTag;\n\n      for (const key in this.props) {\n        const prop = this.props[key];\n        if (prop instanceof AnimatedEvent) {\n          nextEvts.add(prop.__nodeID);\n        } else if (\n          prop?.current &&\n          prop.current instanceof WorkletEventHandler\n        ) {\n          if (viewTag === undefined) {\n            viewTag = prop.current.viewTag;\n          }\n        }\n      }\n      for (const key in prevProps) {\n        const prop = this.props[key];\n        if (prop instanceof AnimatedEvent) {\n          if (!nextEvts.has(prop.__nodeID)) {\n            // event was in prev props but not in current props, we detach\n            prop.detachEvent(node, key);\n          } else {\n            // event was in prev and is still in current props\n            attached.add(prop.__nodeID);\n          }\n        } else if (\n          prop?.current &&\n          prop.current instanceof WorkletEventHandler &&\n          prop.current.reattachNeeded\n        ) {\n          prop.current.unregisterFromEvents();\n        }\n      }\n\n      for (const key in this.props) {\n        const prop = this.props[key];\n        if (prop instanceof AnimatedEvent && !attached.has(prop.__nodeID)) {\n          // not yet attached\n          prop.attachEvent(node, key);\n        } else if (\n          prop?.current &&\n          prop.current instanceof WorkletEventHandler &&\n          prop.current.reattachNeeded\n        ) {\n          prop.current.registerForEvents(viewTag, key);\n          prop.current.reattachNeeded = false;\n        }\n      }\n    }\n\n    // The system is best designed when setNativeProps is implemented. It is\n    // able to avoid re-rendering and directly set the attributes that changed.\n    // However, setNativeProps can only be implemented on native components\n    // If you want to animate a composite component, you need to re-render it.\n    // In this case, we have a fallback that uses forceUpdate.\n    _animatedPropsCallback = () => {\n      if (this._component == null) {\n        // AnimatedProps is created in will-mount because it's used in render.\n        // But this callback may be invoked before mount in async mode,\n        // In which case we should defer the setNativeProps() call.\n        // React may throw away uncommitted work in async mode,\n        // So a deferred call won't always be invoked.\n        this._invokeAnimatedPropsCallbackOnMount = true;\n      } else if (typeof this._component.setNativeProps !== 'function') {\n        this.forceUpdate();\n      } else {\n        this._component.setNativeProps(this._propsAnimated.__getValue());\n      }\n    };\n\n    _attachProps(nextProps) {\n      const oldPropsAnimated = this._propsAnimated;\n\n      this._propsAnimated = createOrReusePropsNode(\n        nextProps,\n        this._animatedPropsCallback,\n        oldPropsAnimated\n      );\n      // If prop node has been reused we don't need to call into \"__detach\"\n      if (oldPropsAnimated !== this._propsAnimated) {\n        // When you call detach, it removes the element from the parent list\n        // of children. If it goes to 0, then the parent also detaches itself\n        // and so on.\n        // An optimization is to attach the new elements and THEN detach the old\n        // ones instead of detaching and THEN attaching.\n        // This way the intermediate state isn't to go to 0 and trigger\n        // this expensive recursive detaching to then re-attach everything on\n        // the very next operation.\n        oldPropsAnimated && oldPropsAnimated.__detach();\n      }\n    }\n\n    _updateFromNative(props) {\n      // eslint-disable-next-line no-unused-expressions\n      this._component.setNativeProps?.(props);\n    }\n\n    _attachPropUpdater() {\n      const viewTag = findNodeHandle(this);\n      NODE_MAPPING.set(viewTag, this);\n      if (NODE_MAPPING.size === 1) {\n        ReanimatedEventEmitter.addListener('onReanimatedPropsChange', listener);\n      }\n    }\n\n    _attachAnimatedStyles() {\n      let styles = Array.isArray(this.props.style)\n        ? this.props.style\n        : [this.props.style];\n      styles = flattenArray(styles);\n      let viewTag, viewName;\n      if (Platform.OS === 'web') {\n        viewTag = findNodeHandle(this);\n        viewName = null;\n      } else {\n        // hostInstance can be null for a component that doesn't render anything (render function returns null). Example: svg Stop: https://github.com/react-native-svg/react-native-svg/blob/develop/src/elements/Stop.tsx\n        const hostInstance = RNRenderer.findHostInstance_DEPRECATED(this);\n        if (!hostInstance) {\n          throw new Error(\n            'Cannot find host instance for this component. Maybe it renders nothing?'\n          );\n        }\n        // we can access view tag in the same way it's accessed here https://github.com/facebook/react/blob/e3f4eb7272d4ca0ee49f27577156b57eeb07cf73/packages/react-native-renderer/src/ReactFabric.js#L146\n        viewTag = hostInstance?._nativeTag;\n        /**\n         * RN uses viewConfig for components for storing different properties of the component(example: https://github.com/facebook/react-native/blob/master/Libraries/Components/ScrollView/ScrollViewViewConfig.js#L16).\n         * The name we're looking for is in the field named uiViewClassName.\n         */\n        viewName = hostInstance?.viewConfig?.uiViewClassName;\n        // update UI props whitelist for this view\n        if (\n          hostInstance &&\n          this._hasReanimated2Props(styles) &&\n          hostInstance.viewConfig\n        ) {\n          adaptViewConfig(hostInstance.viewConfig);\n        }\n      }\n\n      styles.forEach((style) => {\n        if (style?.viewDescriptor) {\n          style.viewDescriptor.value = { tag: viewTag, name: viewName };\n          if (process.env.JEST_WORKER_ID) {\n            /**\n             * We need to connect Jest's TestObject instance whose contains just props object\n             * with the updateProps() function where we update the properties of the component.\n             * We can't update props object directly because TestObject contains a copy of props - look at render function:\n             * const props = this._filterNonAnimatedProps(this.props);\n             */\n            this.animatedStyle.value = {\n              ...this.animatedStyle.value,\n              ...style.initial,\n            };\n            style.animatedStyle.current = this.animatedStyle;\n          }\n        }\n      });\n      // attach animatedProps property\n      if (this.props.animatedProps?.viewDescriptor) {\n        this.props.animatedProps.viewDescriptor.value = {\n          tag: viewTag,\n          name: viewName,\n        };\n      }\n    }\n\n    _hasReanimated2Props(flattenStyles) {\n      if (this.props.animatedProps?.viewDescriptor) {\n        return true;\n      }\n      if (this.props.style) {\n        for (const style of flattenStyles) {\n          // eslint-disable-next-line no-prototype-builtins\n          if (style?.hasOwnProperty('viewDescriptor')) {\n            return true;\n          }\n        }\n      }\n      return false;\n    }\n\n    _detachPropUpdater() {\n      const viewTag = findNodeHandle(this);\n      NODE_MAPPING.delete(viewTag);\n      if (NODE_MAPPING.size === 0) {\n        ReanimatedEventEmitter.removeAllListeners('onReanimatedPropsChange');\n      }\n    }\n\n    componentDidUpdate(prevProps) {\n      this._attachProps(this.props);\n      this._reattachNativeEvents(prevProps);\n\n      this._propsAnimated && this._propsAnimated.setNativeView(this._component);\n    }\n\n    _setComponentRef = setAndForwardRef({\n      getForwardedRef: () => this.props.forwardedRef,\n      setLocalRef: (ref) => {\n        if (ref !== this._component) {\n          this._component = ref;\n        }\n\n        // TODO: Delete this after React Native also deletes this deprecation helper.\n        if (ref != null && ref.getNode == null) {\n          ref.getNode = () => {\n            console.warn(\n              '%s: Calling %s on the ref of an Animated component ' +\n                'is no longer necessary. You can now directly use the ref ' +\n                'instead. This method will be removed in a future release.',\n              ref.constructor.name ?? '<<anonymous>>',\n              'getNode()'\n            );\n            return ref;\n          };\n        }\n      },\n    });\n\n    _filterNonAnimatedStyle(inputStyle) {\n      const style = {};\n      for (const key in inputStyle) {\n        const value = inputStyle[key];\n        if (!hasAnimatedNodes(value)) {\n          style[key] = value;\n        } else if (value instanceof AnimatedValue) {\n          // if any style in animated component is set directly to the `Value` we set those styles to the first value of `Value` node in order\n          // to avoid flash of default styles when `Value` is being asynchrounously sent via bridge and initialized in the native side.\n          style[key] = value._startingValue;\n        }\n      }\n      return style;\n    }\n\n    _filterNonAnimatedProps(inputProps) {\n      const props = {};\n      for (const key in inputProps) {\n        const value = inputProps[key];\n        if (key === 'style') {\n          const styles = Array.isArray(value) ? value : [value];\n          const processedStyle = styles.map((style) => {\n            if (style && style.viewDescriptor) {\n              // this is how we recognize styles returned by useAnimatedStyle\n              if (style.viewRef.current === null) {\n                style.viewRef.current = this;\n              }\n              return style.initial;\n            } else {\n              return style;\n            }\n          });\n          props[key] = this._filterNonAnimatedStyle(\n            StyleSheet.flatten(processedStyle)\n          );\n        } else if (key === 'animatedProps') {\n          Object.keys(value.initial).forEach((key) => {\n            props[key] = value.initial[key];\n            if (value.viewRef.current === null) {\n              value.viewRef.current = this;\n            }\n          });\n        } else if (value instanceof AnimatedEvent) {\n          // we cannot filter out event listeners completely as some components\n          // rely on having a callback registered in order to generate events\n          // alltogether. Therefore we provide a dummy callback here to allow\n          // native event dispatcher to hijack events.\n          props[key] = dummyListener;\n        } else if (\n          value?.current &&\n          value.current instanceof WorkletEventHandler\n        ) {\n          if (value.current.eventNames.length > 0) {\n            value.current.eventNames.forEach((eventName) => {\n              props[eventName] = value.current.listeners\n                ? value.current.listeners[eventName]\n                : dummyListener;\n            });\n          } else {\n            props[key] = dummyListener;\n          }\n        } else if (!(value instanceof AnimatedNode)) {\n          props[key] = value;\n        } else if (value instanceof AnimatedValue) {\n          // if any prop in animated component is set directly to the `Value` we set those props to the first value of `Value` node in order\n          // to avoid default values for a short moment when `Value` is being asynchrounously sent via bridge and initialized in the native side.\n          props[key] = value._startingValue;\n        }\n      }\n      return props;\n    }\n\n    render() {\n      const props = this._filterNonAnimatedProps(this.props);\n      if (process.env.JEST_WORKER_ID) {\n        props.animatedStyle = this.animatedStyle;\n      }\n\n      const platformProps = Platform.select({\n        web: {},\n        default: { collapsable: false },\n      });\n      return (\n        <Component {...props} ref={this._setComponentRef} {...platformProps} />\n      );\n    }\n  }\n\n  AnimatedComponent.displayName = `AnimatedComponent(${\n    Component.displayName || Component.name || 'Component'\n  })`;\n\n  return React.forwardRef(function AnimatedComponentWrapper(props, ref) {\n    return (\n      <AnimatedComponent\n        {...props}\n        {...(ref == null ? null : { forwardedRef: ref })}\n      />\n    );\n  });\n}\n"]},"metadata":{},"sourceType":"module"}