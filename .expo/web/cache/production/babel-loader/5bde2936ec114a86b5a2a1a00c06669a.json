{"ast":null,"code":"import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}import*as React from'react';import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import I18nManager from\"react-native-web/dist/exports/I18nManager\";import Animated,{Easing as OldEasing,EasingNode}from'react-native-reanimated';import memoize from\"./memoize\";var Easing=EasingNode||OldEasing;var multiply=Animated.multiply,Extrapolate=Animated.Extrapolate;var interpolate=Animated.interpolateNode||Animated.interpolate;var TabBarIndicator=function(_React$Component){_inherits(TabBarIndicator,_React$Component);var _super=_createSuper(TabBarIndicator);function TabBarIndicator(){var _this;_classCallCheck(this,TabBarIndicator);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_defineProperty(_assertThisInitialized(_this),\"fadeInIndicator\",function(){var _this$props=_this.props,navigationState=_this$props.navigationState,layout=_this$props.layout,width=_this$props.width,getTabWidth=_this$props.getTabWidth;if(!_this.isIndicatorShown&&width==='auto'&&layout.width&&navigationState.routes.every(function(_,i){return getTabWidth(i);})){_this.isIndicatorShown=true;Animated.timing(_this.opacity,{duration:150,toValue:1,easing:Easing.in(Easing.linear)}).start();}});_defineProperty(_assertThisInitialized(_this),\"isIndicatorShown\",false);_defineProperty(_assertThisInitialized(_this),\"opacity\",new Animated.Value(_this.props.width==='auto'?0:1));_defineProperty(_assertThisInitialized(_this),\"getTranslateX\",memoize(function(position,routes,getTabWidth){var inputRange=routes.map(function(_,i){return i;});var outputRange=routes.reduce(function(acc,_,i){if(i===0)return[0];return[].concat(_toConsumableArray(acc),[acc[i-1]+getTabWidth(i-1)]);},[]);var translateX=interpolate(position,{inputRange:inputRange,outputRange:outputRange,extrapolate:Extrapolate.CLAMP});return multiply(translateX,I18nManager.isRTL?-1:1);}));_defineProperty(_assertThisInitialized(_this),\"getWidth\",memoize(function(position,routes,getTabWidth){var inputRange=routes.map(function(_,i){return i;});var outputRange=inputRange.map(getTabWidth);return interpolate(position,{inputRange:inputRange,outputRange:outputRange,extrapolate:Extrapolate.CLAMP});}));return _this;}_createClass(TabBarIndicator,[{key:\"componentDidMount\",value:function componentDidMount(){this.fadeInIndicator();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){this.fadeInIndicator();}},{key:\"render\",value:function render(){var _this$props2=this.props,position=_this$props2.position,navigationState=_this$props2.navigationState,getTabWidth=_this$props2.getTabWidth,width=_this$props2.width,style=_this$props2.style,layout=_this$props2.layout;var routes=navigationState.routes;var translateX=routes.length>1?this.getTranslateX(position,routes,getTabWidth):0;var indicatorWidth=width==='auto'?routes.length>1?this.getWidth(position,routes,getTabWidth):getTabWidth(0):width;return React.createElement(Animated.View,{style:[styles.indicator,{width:indicatorWidth},layout.width?{transform:[{translateX:translateX}]}:{left:\"\".concat(100/routes.length*navigationState.index,\"%\")},width==='auto'?{opacity:this.opacity}:null,style]});}}]);return TabBarIndicator;}(React.Component);export{TabBarIndicator as default};var styles=StyleSheet.create({indicator:{backgroundColor:'#ffeb3b',position:'absolute',left:0,bottom:0,right:0,height:2}});","map":{"version":3,"sources":["TabBarIndicator.tsx"],"names":["Easing","EasingNode","Extrapolate","interpolate","Animated","React","componentDidMount","componentDidUpdate","getTabWidth","width","layout","navigationState","duration","toValue","easing","memoize","inputRange","routes","outputRange","i","acc","translateX","extrapolate","CLAMP","multiply","I18nManager","render","indicatorWidth","styles","transform","left","opacity","indicator","backgroundColor","position","bottom","right","height"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { StyleSheet, I18nManager, StyleProp, ViewStyle } from 'react-native';\nimport Animated, {\n  Easing as OldEasing,\n  // @ts-ignore\n  EasingNode,\n} from 'react-native-reanimated';\n\nimport memoize from './memoize';\nimport { Route, SceneRendererProps, NavigationState } from './types';\n\nconst Easing = EasingNode || OldEasing;\n\nexport type GetTabWidth = (index: number) => number;\n\nexport type Props<T extends Route> = SceneRendererProps & {\n  navigationState: NavigationState<T>;\n  width: string | number;\n  style?: StyleProp<ViewStyle>;\n  getTabWidth: GetTabWidth;\n};\n\nconst { multiply, Extrapolate } = Animated;\n\n// @ts-ignore\nconst interpolate = Animated.interpolateNode || Animated.interpolate;\n\nexport default class TabBarIndicator<T extends Route> extends React.Component<\n  Props<T>\n> {\n  componentDidMount() {\n    this.fadeInIndicator();\n  }\n\n  componentDidUpdate() {\n    this.fadeInIndicator();\n  }\n\n  private fadeInIndicator = () => {\n    const { navigationState, layout, width, getTabWidth } = this.props;\n\n    if (\n      !this.isIndicatorShown &&\n      width === 'auto' &&\n      layout.width &&\n      // We should fade-in the indicator when we have widths for all the tab items\n      navigationState.routes.every((_, i) => getTabWidth(i))\n    ) {\n      this.isIndicatorShown = true;\n\n      Animated.timing(this.opacity, {\n        duration: 150,\n        toValue: 1,\n        easing: Easing.in(Easing.linear),\n      }).start();\n    }\n  };\n\n  private isIndicatorShown = false;\n\n  private opacity = new Animated.Value(this.props.width === 'auto' ? 0 : 1);\n\n  private getTranslateX = memoize(\n    (\n      position: Animated.Node<number>,\n      routes: Route[],\n      getTabWidth: GetTabWidth\n    ) => {\n      const inputRange = routes.map((_, i) => i);\n\n      // every index contains widths at all previous indices\n      const outputRange = routes.reduce<number[]>((acc, _, i) => {\n        if (i === 0) return [0];\n        return [...acc, acc[i - 1] + getTabWidth(i - 1)];\n      }, []);\n\n      const translateX = interpolate(position, {\n        inputRange,\n        outputRange,\n        extrapolate: Extrapolate.CLAMP,\n      });\n\n      return multiply(translateX, I18nManager.isRTL ? -1 : 1);\n    }\n  );\n\n  private getWidth = memoize(\n    (\n      position: Animated.Node<number>,\n      routes: Route[],\n      getTabWidth: GetTabWidth\n    ) => {\n      const inputRange = routes.map((_, i) => i);\n      const outputRange = inputRange.map(getTabWidth);\n\n      return interpolate(position, {\n        inputRange,\n        outputRange,\n        extrapolate: Extrapolate.CLAMP,\n      });\n    }\n  );\n\n  render() {\n    const {\n      position,\n      navigationState,\n      getTabWidth,\n      width,\n      style,\n      layout,\n    } = this.props;\n    const { routes } = navigationState;\n\n    const translateX =\n      routes.length > 1 ? this.getTranslateX(position, routes, getTabWidth) : 0;\n\n    const indicatorWidth =\n      width === 'auto'\n        ? routes.length > 1\n          ? this.getWidth(position, routes, getTabWidth)\n          : getTabWidth(0)\n        : width;\n\n    return (\n      <Animated.View\n        style={[\n          styles.indicator,\n          // If layout is not available, use `left` property for positioning the indicator\n          // This avoids rendering delay until we are able to calculate translateX\n          { width: indicatorWidth },\n          layout.width\n            ? { transform: [{ translateX }] as any }\n            : { left: `${(100 / routes.length) * navigationState.index}%` },\n          width === 'auto' ? { opacity: this.opacity } : null,\n          style,\n        ]}\n      />\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  indicator: {\n    backgroundColor: '#ffeb3b',\n    position: 'absolute',\n    left: 0,\n    bottom: 0,\n    right: 0,\n    height: 2,\n  },\n});\n"]},"metadata":{},"sourceType":"module"}