{"ast":null,"code":"import _extends from\"@babel/runtime/helpers/extends\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import{Platform,UnavailabilityError}from'@unimodules/core';import*as React from'react';import findNodeHandle from\"react-native-web/dist/exports/findNodeHandle\";import{PermissionStatus}from\"./Camera.types\";import ExponentCamera from\"./ExponentCamera\";import CameraManager from\"./ExponentCameraManager\";import{ConversionTables,ensureNativeProps}from\"./utils/props\";var EventThrottleMs=500;var _PICTURE_SAVED_CALLBACKS={};var _GLOBAL_PICTURE_ID=1;function ensurePictureOptions(options){var pictureOptions=!options||typeof options!=='object'?{}:options;if(!pictureOptions.quality){pictureOptions.quality=1;}if(pictureOptions.onPictureSaved){var id=_GLOBAL_PICTURE_ID++;_PICTURE_SAVED_CALLBACKS[id]=pictureOptions.onPictureSaved;pictureOptions.id=id;pictureOptions.fastMode=true;}return pictureOptions;}function ensureRecordingOptions(options){var recordingOptions=options||{};if(!recordingOptions||typeof recordingOptions!=='object'){recordingOptions={};}else if(typeof recordingOptions.quality==='string'){recordingOptions.quality=Camera.Constants.VideoQuality[recordingOptions.quality];}return recordingOptions;}function _onPictureSaved(_ref){var nativeEvent=_ref.nativeEvent;var id=nativeEvent.id,data=nativeEvent.data;var callback=_PICTURE_SAVED_CALLBACKS[id];if(callback){callback(data);delete _PICTURE_SAVED_CALLBACKS[id];}}var Camera=function(_React$Component){_inherits(Camera,_React$Component);var _super=_createSuper(Camera);function Camera(){var _this;_classCallCheck(this,Camera);_this=_super.apply(this,arguments);_this._lastEvents={};_this._lastEventsTimes={};_this._onCameraReady=function(){if(_this.props.onCameraReady){_this.props.onCameraReady();}};_this._onMountError=function(_ref2){var nativeEvent=_ref2.nativeEvent;if(_this.props.onMountError){_this.props.onMountError(nativeEvent);}};_this._onObjectDetected=function(callback){return function(_ref3){var nativeEvent=_ref3.nativeEvent;var type=nativeEvent.type;if(_this._lastEvents[type]&&_this._lastEventsTimes[type]&&JSON.stringify(nativeEvent)===_this._lastEvents[type]&&new Date().getTime()-_this._lastEventsTimes[type].getTime()<EventThrottleMs){return;}if(callback){callback(nativeEvent);_this._lastEventsTimes[type]=new Date();_this._lastEvents[type]=JSON.stringify(nativeEvent);}};};_this._setReference=function(ref){if(ref){_this._cameraRef=ref;if(Platform.OS==='web'){_this._cameraHandle=ref;}else{_this._cameraHandle=findNodeHandle(ref);}}else{_this._cameraRef=null;_this._cameraHandle=null;}};return _this;}_createClass(Camera,[{key:\"takePictureAsync\",value:function takePictureAsync(options){var pictureOptions;return _regeneratorRuntime.async(function takePictureAsync$(_context){while(1){switch(_context.prev=_context.next){case 0:pictureOptions=ensurePictureOptions(options);_context.next=3;return _regeneratorRuntime.awrap(CameraManager.takePicture(pictureOptions,this._cameraHandle));case 3:return _context.abrupt(\"return\",_context.sent);case 4:case\"end\":return _context.stop();}}},null,this,null,Promise);}},{key:\"getSupportedRatiosAsync\",value:function getSupportedRatiosAsync(){return _regeneratorRuntime.async(function getSupportedRatiosAsync$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(CameraManager.getSupportedRatios){_context2.next=2;break;}throw new UnavailabilityError('Camera','getSupportedRatiosAsync');case 2:_context2.next=4;return _regeneratorRuntime.awrap(CameraManager.getSupportedRatios(this._cameraHandle));case 4:return _context2.abrupt(\"return\",_context2.sent);case 5:case\"end\":return _context2.stop();}}},null,this,null,Promise);}},{key:\"getAvailablePictureSizesAsync\",value:function getAvailablePictureSizesAsync(ratio){return _regeneratorRuntime.async(function getAvailablePictureSizesAsync$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(CameraManager.getAvailablePictureSizes){_context3.next=2;break;}throw new UnavailabilityError('Camera','getAvailablePictureSizesAsync');case 2:_context3.next=4;return _regeneratorRuntime.awrap(CameraManager.getAvailablePictureSizes(ratio,this._cameraHandle));case 4:return _context3.abrupt(\"return\",_context3.sent);case 5:case\"end\":return _context3.stop();}}},null,this,null,Promise);}},{key:\"recordAsync\",value:function recordAsync(options){var recordingOptions;return _regeneratorRuntime.async(function recordAsync$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(CameraManager.record){_context4.next=2;break;}throw new UnavailabilityError('Camera','recordAsync');case 2:recordingOptions=ensureRecordingOptions(options);_context4.next=5;return _regeneratorRuntime.awrap(CameraManager.record(recordingOptions,this._cameraHandle));case 5:return _context4.abrupt(\"return\",_context4.sent);case 6:case\"end\":return _context4.stop();}}},null,this,null,Promise);}},{key:\"stopRecording\",value:function stopRecording(){if(!CameraManager.stopRecording){throw new UnavailabilityError('Camera','stopRecording');}CameraManager.stopRecording(this._cameraHandle);}},{key:\"pausePreview\",value:function pausePreview(){if(!CameraManager.pausePreview){throw new UnavailabilityError('Camera','pausePreview');}CameraManager.pausePreview(this._cameraHandle);}},{key:\"resumePreview\",value:function resumePreview(){if(!CameraManager.resumePreview){throw new UnavailabilityError('Camera','resumePreview');}CameraManager.resumePreview(this._cameraHandle);}},{key:\"render\",value:function render(){var nativeProps=ensureNativeProps(this.props);var onBarCodeScanned=this.props.onBarCodeScanned?this._onObjectDetected(this.props.onBarCodeScanned):undefined;var onFacesDetected=this._onObjectDetected(this.props.onFacesDetected);return React.createElement(ExponentCamera,_extends({},nativeProps,{ref:this._setReference,onCameraReady:this._onCameraReady,onMountError:this._onMountError,onBarCodeScanned:onBarCodeScanned,onFacesDetected:onFacesDetected,onPictureSaved:_onPictureSaved}));}}],[{key:\"isAvailableAsync\",value:function isAvailableAsync(){return _regeneratorRuntime.async(function isAvailableAsync$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(CameraManager.isAvailableAsync){_context5.next=2;break;}throw new UnavailabilityError('expo-camera','isAvailableAsync');case 2:_context5.next=4;return _regeneratorRuntime.awrap(CameraManager.isAvailableAsync());case 4:return _context5.abrupt(\"return\",_context5.sent);case 5:case\"end\":return _context5.stop();}}},null,null,null,Promise);}},{key:\"getAvailableCameraTypesAsync\",value:function getAvailableCameraTypesAsync(){return _regeneratorRuntime.async(function getAvailableCameraTypesAsync$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(CameraManager.getAvailableCameraTypesAsync){_context6.next=2;break;}throw new UnavailabilityError('expo-camera','getAvailableCameraTypesAsync');case 2:_context6.next=4;return _regeneratorRuntime.awrap(CameraManager.getAvailableCameraTypesAsync());case 4:return _context6.abrupt(\"return\",_context6.sent);case 5:case\"end\":return _context6.stop();}}},null,null,null,Promise);}},{key:\"getPermissionsAsync\",value:function getPermissionsAsync(){return _regeneratorRuntime.async(function getPermissionsAsync$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:return _context7.abrupt(\"return\",CameraManager.getPermissionsAsync());case 1:case\"end\":return _context7.stop();}}},null,null,null,Promise);}},{key:\"requestPermissionsAsync\",value:function requestPermissionsAsync(){return _regeneratorRuntime.async(function requestPermissionsAsync$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:return _context8.abrupt(\"return\",CameraManager.requestPermissionsAsync());case 1:case\"end\":return _context8.stop();}}},null,null,null,Promise);}}]);return Camera;}(React.Component);export{Camera as default};Camera.Constants={Type:CameraManager.Type,FlashMode:CameraManager.FlashMode,AutoFocus:CameraManager.AutoFocus,WhiteBalance:CameraManager.WhiteBalance,VideoQuality:CameraManager.VideoQuality,VideoStabilization:CameraManager.VideoStabilization||{}};Camera.ConversionTables=ConversionTables;Camera.defaultProps={zoom:0,ratio:'4:3',focusDepth:0,faceDetectorSettings:{},type:CameraManager.Type.back,autoFocus:CameraManager.AutoFocus.on,flashMode:CameraManager.FlashMode.off,whiteBalance:CameraManager.WhiteBalance.auto};var Constants=Camera.Constants,getPermissionsAsync=Camera.getPermissionsAsync,requestPermissionsAsync=Camera.requestPermissionsAsync;export{Constants,getPermissionsAsync,requestPermissionsAsync};export{PermissionStatus};","map":{"version":3,"sources":["../src/Camera.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Platform, UnavailabilityError } from '@unimodules/core';\nimport * as React from 'react';\nimport { findNodeHandle } from 'react-native';\n\nimport {\n  BarCodeScanningResult,\n  CameraCapturedPicture,\n  CameraMountError,\n  CameraNativeProps,\n  CameraPictureOptions,\n  CameraProps,\n  CameraRecordingOptions,\n  ConstantsType,\n  FaceDetectionResult,\n  PermissionExpiration,\n  PermissionResponse,\n  PermissionStatus,\n} from './Camera.types';\nimport ExponentCamera from './ExponentCamera';\nimport CameraManager from './ExponentCameraManager';\nimport { ConversionTables, ensureNativeProps } from './utils/props';\n\nconst EventThrottleMs = 500;\n\nconst _PICTURE_SAVED_CALLBACKS = {};\n\nlet _GLOBAL_PICTURE_ID = 1;\n\nfunction ensurePictureOptions(options?: CameraPictureOptions): CameraPictureOptions {\n  const pictureOptions: CameraPictureOptions =\n    !options || typeof options !== 'object' ? {} : options;\n\n  if (!pictureOptions.quality) {\n    pictureOptions.quality = 1;\n  }\n  if (pictureOptions.onPictureSaved) {\n    const id = _GLOBAL_PICTURE_ID++;\n    _PICTURE_SAVED_CALLBACKS[id] = pictureOptions.onPictureSaved;\n    pictureOptions.id = id;\n    pictureOptions.fastMode = true;\n  }\n  return pictureOptions;\n}\n\nfunction ensureRecordingOptions(options?: CameraRecordingOptions): CameraRecordingOptions {\n  let recordingOptions = options || {};\n\n  if (!recordingOptions || typeof recordingOptions !== 'object') {\n    recordingOptions = {};\n  } else if (typeof recordingOptions.quality === 'string') {\n    recordingOptions.quality = Camera.Constants.VideoQuality[recordingOptions.quality];\n  }\n\n  return recordingOptions;\n}\n\nfunction _onPictureSaved({\n  nativeEvent,\n}: {\n  nativeEvent: { data: CameraCapturedPicture; id: number };\n}) {\n  const { id, data } = nativeEvent;\n  const callback = _PICTURE_SAVED_CALLBACKS[id];\n  if (callback) {\n    callback(data);\n    delete _PICTURE_SAVED_CALLBACKS[id];\n  }\n}\n\nexport default class Camera extends React.Component<CameraProps> {\n  static async isAvailableAsync(): Promise<boolean> {\n    if (!CameraManager.isAvailableAsync) {\n      throw new UnavailabilityError('expo-camera', 'isAvailableAsync');\n    }\n\n    return await CameraManager.isAvailableAsync();\n  }\n\n  static async getAvailableCameraTypesAsync(): Promise<('front' | 'back')[]> {\n    if (!CameraManager.getAvailableCameraTypesAsync) {\n      throw new UnavailabilityError('expo-camera', 'getAvailableCameraTypesAsync');\n    }\n\n    return await CameraManager.getAvailableCameraTypesAsync();\n  }\n\n  static Constants: ConstantsType = {\n    Type: CameraManager.Type,\n    FlashMode: CameraManager.FlashMode,\n    AutoFocus: CameraManager.AutoFocus,\n    WhiteBalance: CameraManager.WhiteBalance,\n    VideoQuality: CameraManager.VideoQuality,\n    VideoStabilization: CameraManager.VideoStabilization || {},\n  };\n\n  // Values under keys from this object will be transformed to native options\n  static ConversionTables = ConversionTables;\n\n  static defaultProps: CameraProps = {\n    zoom: 0,\n    ratio: '4:3',\n    focusDepth: 0,\n    faceDetectorSettings: {},\n    type: CameraManager.Type.back,\n    autoFocus: CameraManager.AutoFocus.on,\n    flashMode: CameraManager.FlashMode.off,\n    whiteBalance: CameraManager.WhiteBalance.auto,\n  };\n\n  static async getPermissionsAsync(): Promise<PermissionResponse> {\n    return CameraManager.getPermissionsAsync();\n  }\n\n  static async requestPermissionsAsync(): Promise<PermissionResponse> {\n    return CameraManager.requestPermissionsAsync();\n  }\n\n  _cameraHandle?: number | null;\n  _cameraRef?: React.Component | null;\n  _lastEvents: { [eventName: string]: string } = {};\n  _lastEventsTimes: { [eventName: string]: Date } = {};\n\n  async takePictureAsync(options?: CameraPictureOptions): Promise<CameraCapturedPicture> {\n    const pictureOptions = ensurePictureOptions(options);\n\n    return await CameraManager.takePicture(pictureOptions, this._cameraHandle);\n  }\n\n  async getSupportedRatiosAsync(): Promise<string[]> {\n    if (!CameraManager.getSupportedRatios) {\n      throw new UnavailabilityError('Camera', 'getSupportedRatiosAsync');\n    }\n\n    return await CameraManager.getSupportedRatios(this._cameraHandle);\n  }\n\n  async getAvailablePictureSizesAsync(ratio?: string): Promise<string[]> {\n    if (!CameraManager.getAvailablePictureSizes) {\n      throw new UnavailabilityError('Camera', 'getAvailablePictureSizesAsync');\n    }\n    return await CameraManager.getAvailablePictureSizes(ratio, this._cameraHandle);\n  }\n\n  async recordAsync(options?: CameraRecordingOptions): Promise<{ uri: string }> {\n    if (!CameraManager.record) {\n      throw new UnavailabilityError('Camera', 'recordAsync');\n    }\n\n    const recordingOptions = ensureRecordingOptions(options);\n\n    return await CameraManager.record(recordingOptions, this._cameraHandle);\n  }\n\n  stopRecording() {\n    if (!CameraManager.stopRecording) {\n      throw new UnavailabilityError('Camera', 'stopRecording');\n    }\n\n    CameraManager.stopRecording(this._cameraHandle);\n  }\n\n  pausePreview() {\n    if (!CameraManager.pausePreview) {\n      throw new UnavailabilityError('Camera', 'pausePreview');\n    }\n\n    CameraManager.pausePreview(this._cameraHandle);\n  }\n\n  resumePreview() {\n    if (!CameraManager.resumePreview) {\n      throw new UnavailabilityError('Camera', 'resumePreview');\n    }\n\n    CameraManager.resumePreview(this._cameraHandle);\n  }\n\n  _onCameraReady = () => {\n    if (this.props.onCameraReady) {\n      this.props.onCameraReady();\n    }\n  };\n\n  _onMountError = ({ nativeEvent }: { nativeEvent: { message: string } }) => {\n    if (this.props.onMountError) {\n      this.props.onMountError(nativeEvent);\n    }\n  };\n\n  _onObjectDetected = (callback?: Function) => ({ nativeEvent }: { nativeEvent: any }) => {\n    const { type } = nativeEvent;\n    if (\n      this._lastEvents[type] &&\n      this._lastEventsTimes[type] &&\n      JSON.stringify(nativeEvent) === this._lastEvents[type] &&\n      new Date().getTime() - this._lastEventsTimes[type].getTime() < EventThrottleMs\n    ) {\n      return;\n    }\n\n    if (callback) {\n      callback(nativeEvent);\n      this._lastEventsTimes[type] = new Date();\n      this._lastEvents[type] = JSON.stringify(nativeEvent);\n    }\n  };\n\n  _setReference = (ref?: React.Component) => {\n    if (ref) {\n      this._cameraRef = ref;\n      // TODO(Bacon): Unify these - perhaps with hooks?\n      if (Platform.OS === 'web') {\n        this._cameraHandle = ref as any;\n      } else {\n        this._cameraHandle = findNodeHandle(ref);\n      }\n    } else {\n      this._cameraRef = null;\n      this._cameraHandle = null;\n    }\n  };\n\n  render() {\n    const nativeProps = ensureNativeProps(this.props);\n\n    const onBarCodeScanned = this.props.onBarCodeScanned\n      ? this._onObjectDetected(this.props.onBarCodeScanned)\n      : undefined;\n    const onFacesDetected = this._onObjectDetected(this.props.onFacesDetected);\n\n    return (\n      <ExponentCamera\n        {...nativeProps}\n        ref={this._setReference}\n        onCameraReady={this._onCameraReady}\n        onMountError={this._onMountError}\n        onBarCodeScanned={onBarCodeScanned}\n        onFacesDetected={onFacesDetected}\n        onPictureSaved={_onPictureSaved}\n      />\n    );\n  }\n}\n\nexport const { Constants, getPermissionsAsync, requestPermissionsAsync } = Camera;\n\nexport {\n  CameraCapturedPicture,\n  CameraNativeProps,\n  CameraPictureOptions,\n  CameraProps,\n  CameraRecordingOptions,\n  PermissionResponse,\n  PermissionStatus,\n  PermissionExpiration,\n  BarCodeScanningResult,\n  FaceDetectionResult,\n  CameraMountError,\n};\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}