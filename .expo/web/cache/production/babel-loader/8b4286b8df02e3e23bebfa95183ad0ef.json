{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";var _PERMISSION_MODULE_MA;function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createForOfIteratorHelperLoose(o,allowArrayLike){var it=typeof Symbol!==\"undefined\"&&o[Symbol.iterator]||o[\"@@iterator\"];if(it)return(it=it.call(o)).next.bind(it);if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length===\"number\"){if(it)o=it;var i=0;return function(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};};}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}import _regeneratorRuntime from\"@babel/runtime/regenerator\";import Platform from\"react-native-web/dist/exports/Platform\";import{coalesceExpirations,coalesceStatuses,coalesceCanAskAgain,coalesceGranted}from\"./CoalescedPermissions\";import Permissions from\"./ExpoPermissions\";import{PermissionStatus}from\"./Permissions.types\";export{PermissionStatus};export var CAMERA='camera';export var MEDIA_LIBRARY='mediaLibrary';export var MEDIA_LIBRARY_WRITE_ONLY='mediaLibraryWriteOnly';export var CAMERA_ROLL=MEDIA_LIBRARY;export var AUDIO_RECORDING='audioRecording';export var LOCATION='location';export var LOCATION_FOREGROUND='locationForeground';export var LOCATION_BACKGROUND='locationBackground';export var USER_FACING_NOTIFICATIONS='userFacingNotifications';export var NOTIFICATIONS='notifications';export var CONTACTS='contacts';export var CALENDAR='calendar';export var REMINDERS='reminders';export var SYSTEM_BRIGHTNESS='systemBrightness';export var MOTION='motion';var PERMISSION_MODULE_MAPPING=(_PERMISSION_MODULE_MA={},_defineProperty(_PERMISSION_MODULE_MA,CAMERA,'expo-camera'),_defineProperty(_PERMISSION_MODULE_MA,CAMERA_ROLL,'expo-media-library'),_defineProperty(_PERMISSION_MODULE_MA,MEDIA_LIBRARY,'expo-media-library'),_defineProperty(_PERMISSION_MODULE_MA,MEDIA_LIBRARY_WRITE_ONLY,'expo-media-library'),_defineProperty(_PERMISSION_MODULE_MA,AUDIO_RECORDING,'expo-av'),_defineProperty(_PERMISSION_MODULE_MA,LOCATION,'expo-location'),_defineProperty(_PERMISSION_MODULE_MA,USER_FACING_NOTIFICATIONS,'expo-notifications'),_defineProperty(_PERMISSION_MODULE_MA,NOTIFICATIONS,'expo-notifications'),_defineProperty(_PERMISSION_MODULE_MA,CONTACTS,'expo-contacts'),_defineProperty(_PERMISSION_MODULE_MA,CALENDAR,'expo-calendar'),_defineProperty(_PERMISSION_MODULE_MA,REMINDERS,'expo-calendar'),_defineProperty(_PERMISSION_MODULE_MA,SYSTEM_BRIGHTNESS,'expo-brightness'),_defineProperty(_PERMISSION_MODULE_MA,MOTION,'expo-sensors'),_PERMISSION_MODULE_MA);export function getAsync(){var _len,types,_key,_args=arguments;return _regeneratorRuntime.async(function getAsync$(_context){while(1){switch(_context.prev=_context.next){case 0:console.warn(\"expo-permissions is now deprecated \\u2014 the functionality has been moved to other expo packages that directly use these permissions (e.g. expo-location, expo-camera). The package will be removed in the upcoming releases.\");for(_len=_args.length,types=new Array(_len),_key=0;_key<_len;_key++){types[_key]=_args[_key];}if(!(Platform.OS==='ios')){_context.next=6;break;}_context.next=5;return _regeneratorRuntime.awrap(_handleMultiPermissionsRequestIOSAsync(types,Permissions.getAsync));case 5:return _context.abrupt(\"return\",_context.sent);case 6:_context.next=8;return _regeneratorRuntime.awrap(_handlePermissionsRequestAsync(types,Permissions.getAsync));case 8:return _context.abrupt(\"return\",_context.sent);case 9:case\"end\":return _context.stop();}}},null,null,null,Promise);}export function askAsync(){var _len2,types,_key2,_args2=arguments;return _regeneratorRuntime.async(function askAsync$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.warn(\"expo-permissions is now deprecated \\u2014 the functionality has been moved to other expo packages that directly use these permissions (e.g. expo-location, expo-camera). The package will be removed in the upcoming releases.\");for(_len2=_args2.length,types=new Array(_len2),_key2=0;_key2<_len2;_key2++){types[_key2]=_args2[_key2];}if(!(Platform.OS==='ios')){_context2.next=6;break;}_context2.next=5;return _regeneratorRuntime.awrap(_handleMultiPermissionsRequestIOSAsync(types,Permissions.askAsync));case 5:return _context2.abrupt(\"return\",_context2.sent);case 6:_context2.next=8;return _regeneratorRuntime.awrap(_handlePermissionsRequestAsync(types,Permissions.askAsync));case 8:return _context2.abrupt(\"return\",_context2.sent);case 9:case\"end\":return _context2.stop();}}},null,null,null,Promise);}function _handleSinglePermissionRequestIOSAsync(type,handlePermission){var library;return _regeneratorRuntime.async(function _handleSinglePermissionRequestIOSAsync$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(Platform.OS!=='web'&&type==='motion')){_context3.next=2;break;}return _context3.abrupt(\"return\",{status:PermissionStatus.GRANTED,expires:'never',granted:true,canAskAgain:true});case 2:_context3.prev=2;_context3.next=5;return _regeneratorRuntime.awrap(handlePermission(type));case 5:return _context3.abrupt(\"return\",_context3.sent);case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](2);if(_context3.t0.code==='E_PERMISSIONS_UNKNOWN'&&PERMISSION_MODULE_MAPPING[type]){library=PERMISSION_MODULE_MAPPING[type];_context3.t0.message=_context3.t0.message+\", please install and link the package \"+PERMISSION_MODULE_MAPPING[type]+\", see more at https://github.com/expo/expo/tree/master/packages/\"+library;}throw _context3.t0;case 12:case\"end\":return _context3.stop();}}},null,null,[[2,8]],Promise);}function _handleMultiPermissionsRequestIOSAsync(types,handlePermission){var permissions,_iterator,_step,type;return _regeneratorRuntime.async(function _handleMultiPermissionsRequestIOSAsync$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(types.length){_context4.next=2;break;}throw new Error('At least one permission type must be specified');case 2:permissions={};_iterator=_createForOfIteratorHelperLoose(types);case 4:if((_step=_iterator()).done){_context4.next=11;break;}type=_step.value;_context4.next=8;return _regeneratorRuntime.awrap(_handleSinglePermissionRequestIOSAsync(type,handlePermission));case 8:permissions[type]=_context4.sent;case 9:_context4.next=4;break;case 11:return _context4.abrupt(\"return\",{status:coalesceStatuses(permissions),expires:coalesceExpirations(permissions),canAskAgain:coalesceCanAskAgain(permissions),granted:coalesceGranted(permissions),permissions:permissions});case 12:case\"end\":return _context4.stop();}}},null,null,null,Promise);}function _handlePermissionsRequestAsync(types,handlePermissions){var approvedPermission,permissions;return _regeneratorRuntime.async(function _handlePermissionsRequestAsync$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(types.length){_context5.next=2;break;}throw new Error('At least one permission type must be specified');case 2:if(!(Platform.OS!=='web'&&types.length===1&&types[0]==='motion')){_context5.next=5;break;}approvedPermission={status:PermissionStatus.GRANTED,expires:'never',granted:true,canAskAgain:true};return _context5.abrupt(\"return\",_objectSpread(_objectSpread({},approvedPermission),{},{permissions:{motion:approvedPermission}}));case 5:_context5.next=7;return _regeneratorRuntime.awrap(handlePermissions(types));case 7:permissions=_context5.sent;return _context5.abrupt(\"return\",{status:coalesceStatuses(permissions),expires:coalesceExpirations(permissions),canAskAgain:coalesceCanAskAgain(permissions),granted:coalesceGranted(permissions),permissions:permissions});case 9:case\"end\":return _context5.stop();}}},null,null,null,Promise);}","map":{"version":3,"sources":["../src/Permissions.ts"],"names":[],"mappings":"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","sourcesContent":["import { Platform } from 'react-native';\n\nimport {\n  coalesceExpirations,\n  coalesceStatuses,\n  coalesceCanAskAgain,\n  coalesceGranted,\n} from './CoalescedPermissions';\nimport Permissions from './ExpoPermissions';\nimport {\n  PermissionResponse,\n  PermissionType,\n  PermissionMap,\n  PermissionStatus,\n  PermissionExpiration,\n  PermissionInfo,\n} from './Permissions.types';\n\nexport {\n  PermissionStatus,\n  PermissionResponse,\n  PermissionExpiration,\n  PermissionMap,\n  PermissionInfo,\n  PermissionType,\n};\n\nexport const CAMERA = 'camera';\nexport const MEDIA_LIBRARY = 'mediaLibrary';\nexport const MEDIA_LIBRARY_WRITE_ONLY = 'mediaLibraryWriteOnly';\n/**\n * @deprecated Use `MEDIA_LIBRARY` or `MEDIA_LIBRARY_WRITE_ONLY`\n */\nexport const CAMERA_ROLL = MEDIA_LIBRARY;\nexport const AUDIO_RECORDING = 'audioRecording';\n/** @deprecated Use `LOCATION_FOREGROUND` or `LOCATION_BACKGROUND` instead */\nexport const LOCATION = 'location';\nexport const LOCATION_FOREGROUND = 'locationForeground';\nexport const LOCATION_BACKGROUND = 'locationBackground';\nexport const USER_FACING_NOTIFICATIONS = 'userFacingNotifications';\nexport const NOTIFICATIONS = 'notifications';\nexport const CONTACTS = 'contacts';\nexport const CALENDAR = 'calendar';\nexport const REMINDERS = 'reminders';\nexport const SYSTEM_BRIGHTNESS = 'systemBrightness';\nexport const MOTION = 'motion';\n\n// Map corresponding permission to correct package\nconst PERMISSION_MODULE_MAPPING = {\n  [CAMERA]: 'expo-camera',\n  [CAMERA_ROLL]: 'expo-media-library',\n  [MEDIA_LIBRARY]: 'expo-media-library',\n  [MEDIA_LIBRARY_WRITE_ONLY]: 'expo-media-library',\n  [AUDIO_RECORDING]: 'expo-av',\n  [LOCATION]: 'expo-location',\n  [USER_FACING_NOTIFICATIONS]: 'expo-notifications',\n  [NOTIFICATIONS]: 'expo-notifications',\n  [CONTACTS]: 'expo-contacts',\n  [CALENDAR]: 'expo-calendar',\n  [REMINDERS]: 'expo-calendar',\n  [SYSTEM_BRIGHTNESS]: 'expo-brightness',\n  [MOTION]: 'expo-sensors',\n};\n\nexport async function getAsync(...types: PermissionType[]): Promise<PermissionResponse> {\n  console.warn(\n    `expo-permissions is now deprecated — the functionality has been moved to other expo packages that directly use these permissions (e.g. expo-location, expo-camera). The package will be removed in the upcoming releases.`\n  );\n\n  if (Platform.OS === 'ios') {\n    return await _handleMultiPermissionsRequestIOSAsync(types, Permissions.getAsync);\n  }\n  return await _handlePermissionsRequestAsync(types, Permissions.getAsync);\n}\n\nexport async function askAsync(...types: PermissionType[]): Promise<PermissionResponse> {\n  console.warn(\n    `expo-permissions is now deprecated — the functionality has been moved to other expo packages that directly use these permissions (e.g. expo-location, expo-camera). The package will be removed in the upcoming releases.`\n  );\n\n  if (Platform.OS === 'ios') {\n    return await _handleMultiPermissionsRequestIOSAsync(types, Permissions.askAsync);\n  }\n  return await _handlePermissionsRequestAsync(types, Permissions.askAsync);\n}\n\nasync function _handleSinglePermissionRequestIOSAsync(\n  type: PermissionType,\n  handlePermission: (type: PermissionType) => Promise<PermissionInfo>\n): Promise<PermissionInfo> {\n  if (Platform.OS !== 'web' && type === 'motion') {\n    return {\n      status: PermissionStatus.GRANTED,\n      expires: 'never',\n      granted: true,\n      canAskAgain: true,\n    };\n  }\n  try {\n    return await handlePermission(type);\n  } catch (error) {\n    // We recognize the permission's library, so we inform the user to link that library to request the permission.\n    if (error.code === 'E_PERMISSIONS_UNKNOWN' && PERMISSION_MODULE_MAPPING[type]) {\n      const library = PERMISSION_MODULE_MAPPING[type];\n      error.message = `${error.message}, please install and link the package ${PERMISSION_MODULE_MAPPING[type]}, see more at https://github.com/expo/expo/tree/master/packages/${library}`;\n    }\n    throw error;\n  }\n}\n\nasync function _handleMultiPermissionsRequestIOSAsync(\n  types: PermissionType[],\n  handlePermission: (type: PermissionType) => Promise<PermissionInfo>\n): Promise<PermissionResponse> {\n  if (!types.length) {\n    throw new Error('At least one permission type must be specified');\n  }\n\n  const permissions = {};\n  for (const type of types) {\n    permissions[type] = await _handleSinglePermissionRequestIOSAsync(type, handlePermission);\n  }\n\n  return {\n    status: coalesceStatuses(permissions),\n    expires: coalesceExpirations(permissions),\n    canAskAgain: coalesceCanAskAgain(permissions),\n    granted: coalesceGranted(permissions),\n    permissions,\n  };\n}\n\nasync function _handlePermissionsRequestAsync(\n  types: PermissionType[],\n  handlePermissions: (types: PermissionType[]) => Promise<PermissionMap>\n): Promise<PermissionResponse> {\n  if (!types.length) {\n    throw new Error('At least one permission type must be specified');\n  }\n\n  if (Platform.OS !== 'web' && types.length === 1 && types[0] === 'motion') {\n    const approvedPermission = {\n      status: PermissionStatus.GRANTED,\n      expires: 'never',\n      granted: true,\n      canAskAgain: true,\n    };\n    return {\n      ...approvedPermission,\n      // @ts-ignore\n      permissions: { motion: approvedPermission },\n    };\n  }\n\n  const permissions = await handlePermissions(types);\n  return {\n    status: coalesceStatuses(permissions),\n    expires: coalesceExpirations(permissions),\n    canAskAgain: coalesceCanAskAgain(permissions),\n    granted: coalesceGranted(permissions),\n    permissions,\n  };\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}